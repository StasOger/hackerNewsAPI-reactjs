{"ast":null,"code":"import _regeneratorRuntime from\"D:/JsProjects/hacker-news-main/hackerNewsAPI-reactjs/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"D:/JsProjects/hacker-news-main/hackerNewsAPI-reactjs/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:/JsProjects/hacker-news-main/hackerNewsAPI-reactjs/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useState,useEffect}from\"react\";import React from\"react\";import{BrowserRouter as Router,Outlet,useNavigate}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export default function FetchNews(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),stories=_useState2[0],setStories=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),storiess=_useState4[0],setStoriess=_useState4[1];var _useState5=useState(\"programming\"),_useState6=_slicedToArray(_useState5,2),query=_useState6[0],setQuery=_useState6[1];var _useState7=useState(true),_useState8=_slicedToArray(_useState7,2),isLoading=_useState8[0],setIsLoading=_useState8[1];var navigate=useNavigate();useEffect(function(){setIsLoading(true);var fetchNews=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var api_url_newstories,idStories,step,api_urlStory,story;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return fetch(\"https://hacker-news.firebaseio.com/v0/newstories.json?print=pretty\");case 2:api_url_newstories=_context.sent;_context.next=5;return api_url_newstories.json();case 5:idStories=_context.sent;step=0;case 7:if(!(step<100)){_context.next=18;break;}_context.next=10;return fetch(\"https://hacker-news.firebaseio.com/v0/item/\".concat(idStories[step],\".json?print=pretty\\\"\"));case 10:api_urlStory=_context.sent;_context.next=13;return api_urlStory.json();case 13:story=_context.sent;if(story!=null){stories.push(story);}case 15:step++;_context.next=7;break;case 18:setStoriess(stories);case 19:case\"end\":return _context.stop();}}},_callee);}));return function fetchNews(){return _ref.apply(this,arguments);};}();fetchNews();setIsLoading(false);},[query]);var handleSubmit=function handleSubmit(e){e.preventDefault();window.location.reload();};return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"main\",{children:isLoading?/*#__PURE__*/_jsx(\"div\",{className:\"spinner\"}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:handleSubmit,className:\"bg-white border border-gray-700 lg:text-xl py-2 px-6 rounded lg:pb-3 text-gray-700 hover:bg-transparent transition-all duration-150\",children:\"Reload\"}),/*#__PURE__*/_jsx(\"section\",{className:\"grid grid-cols-1 gap-5 p-5 md:grid-cols-2 container mx-auto lg:max-w-4xl\",children:storiess.flatMap(function(item){var by=item.by,id=item.id,time=item.time,title=item.title,url=item.url,descendants=item.descendants;// конвертируем дату из long в date\nvar date=new Date(time*1000);var options={weekday:'long',day:'numeric',year:'numeric',month:'long'};return/*#__PURE__*/_jsxs(\"button\",{onClick:/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(event){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:navigate(\"/Item/\".concat(id));case 1:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x){return _ref2.apply(this,arguments);};}(),children:[/*#__PURE__*/_jsxs(\"article\",{className:\"bg-gray-800 rounded p-3 transition-all duration-150\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-bold text-white text-lg mb-3\",children:title}),/*#__PURE__*/_jsxs(\"article\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-600\",children:[\"By \",/*#__PURE__*/_jsx(\"em\",{children:by})]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-600\",children:[\"Comments: \",descendants]})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-400 mt-10\",children:date.toLocaleDateString(\"en-US\",options)})]},id),/*#__PURE__*/_jsx(Outlet,{})]});})})]})})});}","map":{"version":3,"sources":["D:/JsProjects/hacker-news-main/hackerNewsAPI-reactjs/src/components/FetchNews.jsx"],"names":["useState","useEffect","React","BrowserRouter","Router","Outlet","useNavigate","FetchNews","stories","setStories","storiess","setStoriess","query","setQuery","isLoading","setIsLoading","navigate","fetchNews","fetch","api_url_newstories","json","idStories","step","api_urlStory","story","push","handleSubmit","e","preventDefault","window","location","reload","flatMap","item","by","id","time","title","url","descendants","date","Date","options","weekday","day","year","month","event","toLocaleDateString"],"mappings":"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","sourcesContent":["import { useState, useEffect } from \"react\"\r\nimport React from \"react\";\r\nimport { BrowserRouter as Router,  Outlet, useNavigate } from \"react-router-dom\";\r\n\r\n\r\nexport default function FetchNews() {\r\n\r\n  \r\n  const [stories, setStories] = useState([])\r\n  const [storiess, setStoriess] = useState([])\r\n  const [query, setQuery] = useState(\"programming\")\r\n  const [isLoading, setIsLoading] = useState(true) \r\n  const navigate = useNavigate();\r\n\r\n  useEffect(() => {\r\n    setIsLoading(true)\r\n    const fetchNews = async () => {\r\n\r\n      const api_url_newstories = await \r\n      fetch (\r\n      \"https://hacker-news.firebaseio.com/v0/newstories.json?print=pretty\"\r\n      )\r\n      const idStories = await api_url_newstories.json();\r\n      \r\n      var step;\r\n          // выбираем 100 новых новостей\r\n          for (step = 0; step < 100; step++) {\r\n              // Открываем страницу новости\r\n              const api_urlStory = await\r\n              fetch (\r\n              `https://hacker-news.firebaseio.com/v0/item/${idStories[step]}.json?print=pretty\"`\r\n              )\r\n              const story = await api_urlStory.json();\r\n              if (story != null){\r\n                stories.push(story); \r\n              }\r\n          } \r\n          setStoriess(stories);\r\n    }\r\n    fetchNews()\r\n    setIsLoading(false)\r\n  }, [query])\r\n\r\n  const handleSubmit = (e) => {\r\n    e.preventDefault()\r\n    window.location.reload();\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <main>\r\n        {isLoading ? (\r\n          <div className=\"spinner\"></div>\r\n        ) : (\r\n          <>\r\n            <button\r\n                      type=\"button\"\r\n                      onClick={handleSubmit}\r\n                      className=\"bg-white border border-gray-700 lg:text-xl py-2 px-6 rounded lg:pb-3 text-gray-700 hover:bg-transparent transition-all duration-150\"\r\n                    >\r\n                      Reload\r\n                    </button>\r\n            <section className=\"grid grid-cols-1 gap-5 p-5 md:grid-cols-2 container mx-auto lg:max-w-4xl\">\r\n              {\r\n                storiess.flatMap((item) => {\r\n\r\n                const { by, id,  time, title, url, descendants } = item\r\n\r\n                // конвертируем дату из long в date\r\n                let date = new Date(time*1000);\r\n                let options = { weekday: 'long', day: 'numeric', year: 'numeric', month: 'long' };\r\n                \r\n\r\n                return (\r\n                  <button onClick={async event => { navigate(`/Item/${id}`); }}>\r\n                    <article\r\n                      key={id}\r\n                      className=\"bg-gray-800 rounded p-3 transition-all duration-150\"\r\n                    >\r\n                    <h3 className=\"font-bold text-white text-lg mb-3\">\r\n                      {title}\r\n                    </h3>      \r\n                    <article className=\"flex items-center justify-between\">\r\n                      <p className=\"text-gray-600\">\r\n                        By <em>{by}</em>\r\n                      </p>\r\n                      <p className=\"text-gray-600\">\r\n                      Comments: {descendants}\r\n                      </p>\r\n                    </article>\r\n                    <p className=\"text-gray-400 mt-10\">\r\n                      {date.toLocaleDateString(\"en-US\", options)}\r\n                    </p>\r\n                    </article>\r\n                    <Outlet />\r\n                  </button>\r\n                )\r\n              })}\r\n            </section>\r\n          </>\r\n        )}\r\n      </main>\r\n    </>\r\n  )\r\n}"]},"metadata":{},"sourceType":"module"}